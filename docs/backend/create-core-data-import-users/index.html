<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Create core data and import users · Caritas Online-Beratung</title><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta name="generator" content="Docusaurus"/><meta name="description" content="## AgencyService: Create master data"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Create core data and import users · Caritas Online-Beratung"/><meta property="og:type" content="website"/><meta property="og:url" content="https://caritasdeutschland.github.io/documentation/"/><meta property="og:description" content="## AgencyService: Create master data"/><meta property="og:image" content="https://caritasdeutschland.github.io/documentation/img/undraw_online.svg"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://caritasdeutschland.github.io/documentation/img/undraw_tweetstorm.svg"/><link rel="shortcut icon" href="/documentation/img/favicon.png"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script src="/documentation/js/scrollSpy.js"></script><link rel="stylesheet" href="/documentation/css/main.css"/><script src="/documentation/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/documentation/"><img class="logo" src="/documentation/img/caritas_logo.svg" alt="Caritas Online-Beratung"/><h2 class="headerTitleWithLogo">Caritas Online-Beratung</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class="siteNavGroupActive"><a href="/documentation/docs/general/home" target="_self">Docs</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>Backend setup and configuration</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle">General</h3><ul class=""><li class="navListItem"><a class="navItem" href="/documentation/docs/general/home">Home</a></li><li class="navListItem"><a class="navItem" href="/documentation/docs/general/git-workflow">Git workflow</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Project setup</h3><ul class=""><li class="navListItem"><a class="navItem" href="/documentation/docs/setup/setup-backend">Setting up the backend</a></li><li class="navListItem"><a class="navItem" href="/documentation/docs/setup/setup-frontend">Setting up the frontend</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Backend setup and configuration</h3><ul class=""><li class="navListItem"><a class="navItem" href="/documentation/docs/backend/install-and-running-on-server">Installing and running the backend on the server</a></li><li class="navListItem"><a class="navItem" href="/documentation/docs/backend/install-and-running-locally">Installing and running the backend for local development</a></li><li class="navListItem"><a class="navItem" href="/documentation/docs/backend/first-start">First start</a></li><li class="navListItem"><a class="navItem" href="/documentation/docs/backend/service-configuration">Service configuration</a></li><li class="navListItem"><a class="navItem" href="/documentation/docs/backend/file-permissions">File permissions</a></li><li class="navListItem"><a class="navItem" href="/documentation/docs/backend/openldap-configuration">Configure OpenLDAP</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/documentation/docs/backend/create-core-data-import-users">Create core data and import users</a></li><li class="navListItem"><a class="navItem" href="/documentation/docs/backend/mailservice-templates">Mail templates</a></li><li class="navListItem"><a class="navItem" href="/documentation/docs/backend/jenkins">Setting up the build process via Jenkins</a></li><li class="navListItem"><a class="navItem" href="/documentation/docs/backend/nginx">NGINX configuration</a></li><li class="navListItem"><a class="navItem" href="/documentation/docs/backend/ssl-certificate">SSL certificate</a></li><li class="navListItem"><a class="navItem" href="/documentation/docs/backend/cors-configuration">CORS configuration</a></li><li class="navListItem"><a class="navItem" href="/documentation/docs/backend/video-backend">Installing and running the videoBackend</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Backend in general</h3><ul class=""><li class="navListItem"><a class="navItem" href="/documentation/docs/backend/service-overview">Service overview</a></li><li class="navListItem"><a class="navItem" href="/documentation/docs/backend/starting-and-stopping-the-services">Starting and stopping the services</a></li><li class="navListItem"><a class="navItem" href="/documentation/docs/backend/login-data-access-links">Login data and access links</a></li><li class="navListItem"><a class="navItem" href="/documentation/docs/backend/admin-api">Admin API</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Backend development</h3><ul class=""><li class="navListItem"><a class="navItem" href="/documentation/docs/backend/build-and-load-docker-image">Build Docker image locally and load it into Docker</a></li><li class="navListItem"><a class="navItem" href="/documentation/docs/backend/liquibase">Database versioning with liquibase</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Frontend</h3><ul class=""><li class="navListItem"><a class="navItem" href="/documentation/docs/frontend/build">Build</a></li><li class="navListItem"><a class="navItem" href="/documentation/docs/frontend/tools-and-technologies">Tools and Technologies</a></li><li class="navListItem"><a class="navItem" href="/documentation/docs/frontend/testing">Testing</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Quality Assurance</h3><ul class=""><li class="navListItem"><a class="navItem" href="/documentation/docs/quality-assurance/browser-matrix">Browser matrix</a></li><li class="navListItem"><a class="navItem" href="/documentation/docs/quality-assurance/test-cases">Testcases</a></li><li class="navListItem"><a class="navItem" href="/documentation/docs/quality-assurance/smoke-testsuite">Smoke Test Suite</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Releases</h3><ul class=""><li class="navListItem"><a class="navItem" href="/documentation/docs/releases/overview">Overview</a></li><li class="navListItem"><a class="navItem" href="/documentation/docs/releases/versionhistory">Version History</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Releases of own services</h3><ul class=""><li class="navListItem"><a class="navItem" href="/documentation/docs/releases/agencyservice">AgencyService</a></li><li class="navListItem"><a class="navItem" href="/documentation/docs/releases/backend">Backend stack - Backend</a></li><li class="navListItem"><a class="navItem" href="/documentation/docs/releases/consultingtypeservice">ConsultingTypeService</a></li><li class="navListItem"><a class="navItem" href="/documentation/docs/releases/frontend">Frontend</a></li><li class="navListItem"><a class="navItem" href="/documentation/docs/releases/liveservice">LiveService</a></li><li class="navListItem"><a class="navItem" href="/documentation/docs/releases/mailservice">MailService</a></li><li class="navListItem"><a class="navItem" href="/documentation/docs/releases/messageservice">MessageService</a></li><li class="navListItem"><a class="navItem" href="/documentation/docs/releases/uploadservice">UploadService</a></li><li class="navListItem"><a class="navItem" href="/documentation/docs/releases/userservice">UserService</a></li><li class="navListItem"><a class="navItem" href="/documentation/docs/releases/videoservice">VideoService</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Releases of 3rd party components</h3><ul class=""><li class="navListItem"><a class="navItem" href="/documentation/docs/releases/adminer">3rd party - Adminer</a></li><li class="navListItem"><a class="navItem" href="/documentation/docs/releases/keycloak">3rd party - Keycloak</a></li><li class="navListItem"><a class="navItem" href="/documentation/docs/releases/mariadb">3rd party - MariaDB</a></li><li class="navListItem"><a class="navItem" href="/documentation/docs/releases/mongodb">3rd party - MongoDB</a></li><li class="navListItem"><a class="navItem" href="/documentation/docs/releases/nginx">NGINX</a></li><li class="navListItem"><a class="navItem" href="/documentation/docs/releases/nosqlclient">3rd party -  Nosqlclient</a></li><li class="navListItem"><a class="navItem" href="/documentation/docs/releases/openldap">3rd party - OpenLDAP</a></li><li class="navListItem"><a class="navItem" href="/documentation/docs/releases/rocketchat">3rd party - Rocket.Chat</a></li><li class="navListItem"><a class="navItem" href="/documentation/docs/releases/videobackend">Backend stack - VideoBackend</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><h1 id="__docusaurus" class="postHeaderTitle">Create core data and import users</h1></header><article><div><span><h2><a class="anchor" aria-hidden="true" id="agencyservice-create-master-data"></a><a href="#agencyservice-create-master-data" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>AgencyService: Create master data</h2>
<p>For the AgencyService, master data (consulting offices, etc.) must be created. For this purpose, the following SQL statements can be executed in the admin (note the order):</p>
<h3><a class="anchor" aria-hidden="true" id="create-dioceses"></a><a href="#create-dioceses" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Create dioceses</h3>
<p><code>use agencyservice;</code><br>
<code>INSERT INTO agencyservice.diocese (id, name, create_date, update_date) values (NEXTVAL(sequence_diocese), `&lt;dioceseName&gt;`, now(), now());</code>\</p>
<h3><a class="anchor" aria-hidden="true" id="create-agencies"></a><a href="#create-agencies" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Create agencies</h3>
<p><code>use agencyservice;</code><br>
<code>INSERT INTO `agency` (`id`, `diocese_id`, `name`, `description`, `postcode`, `city`, `is_team_agency`, `consulting_type`, `is_offline`, `create_date`, `update_date`) VALUES</code><br>
<code>(NEXTVAL(sequence_agency), 1, '&lt;agencyName&gt;', '&lt;agencyDescription&gt;', '&lt;postcode&gt;', '&lt;city&gt;', &lt;isTeamAgency&gt;, &lt;consultingType&gt;, &lt;isOffline&gt;, now(), now());</code>\</p>
<h2><a class="anchor" aria-hidden="true" id="userservice-consultant-import"></a><a href="#userservice-consultant-import" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>UserService: Consultant Import</h2>
<p>Consultants can be imported via the UserService. Consultants can be created from scratch or additional consultants can be assigned to existing consultants. The import is currently not designed to change further data for existing consultants.</p>
<p>During the import, the corresponding accounts are created in Keycloak, in Rocket.Chat and in the application database. It also assigns the specified consulting locations to the consultants and adds the consultants to the necessary Rocket.Chat rooms for existing initial requests.</p>
<p>The import is done via a CSV file with the following format (<strong>Headlines must be removed for import</strong>):</p>
<h3><a class="anchor" aria-hidden="true" id="example-import-new-creation"></a><a href="#example-import-new-creation" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Example import (new creation)</h3>
<pre><code class="hljs">consultant<span class="hljs-number">_</span>id,old<span class="hljs-number">_</span>id,username,first<span class="hljs-number">_n</span>ame,last<span class="hljs-number">_n</span>ame,email,<span class="hljs-keyword">is</span><span class="hljs-number">_</span>absent,absence<span class="hljs-number">_m</span>essage,<span class="hljs-string">"agency_id;roleset,agency_id;roleset"</span>
,<span class="hljs-number">1</span>,mueller,Max,Müller,max.meuller<span class="hljs-meta">@domain</span>.de,nein,<span class="hljs-string">""</span>,<span class="hljs-string">"300;main,301;main"</span>
,<span class="hljs-number">2</span>,meier,Werner,meier,werner.meier<span class="hljs-meta">@domain</span>.de,ja,<span class="hljs-string">"I am currently not available."</span>,<span class="hljs-string">"300;main"</span>
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="update-example"></a><a href="#update-example" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Update example</h3>
<pre><code class="hljs"><span class="hljs-built_in">consultant_id,</span>old_id,username,first_name,last_name,email,is_absent,absence_message,<span class="hljs-string">"agency_id;roleset,agency_id;roleset"</span>
KSJDD88-<span class="hljs-number">0339393</span>-<span class="hljs-number">9999</span>DDD,,mueller,,max.meuller@domain.de,,,,,<span class="hljs-string">"304;main,305;main"</span>
</code></pre>
<p><strong>Note</strong>: Currently, only the named consulting offices are assigned during an update. There is no update in the user name or email address.</p>
<h3><a class="anchor" aria-hidden="true" id="description-of-the-fields"></a><a href="#description-of-the-fields" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Description of the fields</h3>
<table>
<thead>
<tr><th>Field</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>consultant_id</td><td>Keycloak-ID</td></tr>
<tr><td>id_old</td><td>ID from the old consulting platform</td></tr>
<tr><td>username</td><td>Username</td></tr>
<tr><td>first_name</td><td>First name</td></tr>
<tr><td>last_name</td><td>Last name</td></tr>
<tr><td>email</td><td>E-mail address</td></tr>
<tr><td>is_absent</td><td>Specifies whether a consultant should be set to absent. Permitted values: yes/no</td></tr>
<tr><td>absence_message</td><td>Absence note</td></tr>
<tr><td>agency_rolesets</td><td>Consulting center ID; role in the consulting center (can be taken from the consulting type settings in the service). Multiple consulting centers can be specified comma-separated</td></tr>
</tbody>
</table>
<p>The name and location of the CSV file is set in the <em>application.properties</em> via the <code>consultant.import.filename</code>.</p>
<h2><a class="anchor" aria-hidden="true" id="start-import"></a><a href="#start-import" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Start import</h2>
<p>The import of the consultants can be done by calling the endpoint <strong>/users/consultants/import</strong> at the UserService (e.g. with Postman). It should be noted that a valid keycloak token of a technical user with the role <em>&quot;technical&quot;</em> must be passed. The call is possible 1x per minute.</p>
<h3><a class="anchor" aria-hidden="true" id="import-log"></a><a href="#import-log" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Import log</h3>
<p>During the import, a log is written to a file. This file is also located in the root directory of the UserService and has the name
&quot;consultants-import.txt&quot;. In addition, a timestamp is appended so that the file is not overwritten during multiple runs.</p>
<p>The file contains all necessary data to generate e.g. e-mails to the consultants:</p>
<ul>
<li>First name</li>
<li>Last name</li>
<li>E-mail address</li>
<li>Username</li>
</ul>
<h2><a class="anchor" aria-hidden="true" id="userservice-import-of-advice-seekers-with-advice"></a><a href="#userservice-import-of-advice-seekers-with-advice" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>UserService: Import of advice seekers with advice</h2>
<p>UserService can be used to import advice seekers with advice. During the import, the corresponding accounts are created in Keycloak, in Rocket.Chat and in the application database. In addition, an initial consultation with welcome message is created. The consultation is assigned to the specified consultation center and the specified consultant.</p>
<p>The import is done via a CSV file with the following format (<strong>The headlines must be removed for the import</strong>):</p>
<pre><code class="hljs">id_old,username,email,consultant_id,postcode,agency_id,pw
<span class="hljs-number">219344</span>,helpseeker,<span class="hljs-symbol">asker@</span>problem.com,fc68b24e-bc0f<span class="hljs-number">-4</span>cb5-a215<span class="hljs-number">-7</span>bef0d79ee2d,<span class="hljs-number">53111</span>,<span class="hljs-number">168</span>,jjuasd8§$jk!
,helpseeker2,<span class="hljs-symbol">asker2@</span>problem.com,fc68b24e-bc0f<span class="hljs-number">-4</span>cb5-a215<span class="hljs-number">-7</span>bef0d79ee2d,<span class="hljs-number">53111</span>,<span class="hljs-number">168</span>,
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="fields-description"></a><a href="#fields-description" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Fields description</h3>
<table>
<thead>
<tr><th>Field</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>id_old</td><td>ID from the old consulting platform</td></tr>
<tr><td>username</td><td>Username</td></tr>
<tr><td>email</td><td>E-Mail address</td></tr>
<tr><td>consultant_id</td><td>keycloak ID of the consultant to be assigned</td></tr>
<tr><td>postcode</td><td>postal code to be assigned to the consultant (usually comes from the registration)</td></tr>
<tr><td>agency_id</td><td>ID of the consultant to be assigned</td></tr>
<tr><td>pw</td><td>password (optional). If no password is specified, a generated one will be assigned.</td></tr>
</tbody>
</table>
<p>The name and location of the CSV file is specified in the <em>application.properties</em> via the <code>asker.import.filename</code>.</p>
<p>The welcome default system message file is also specified in the <em>application.properties</em>. Here the consulting type PLatzhalter is replaced with the respective ID of the resort. The files must be located in the same directory as the import file. Here it is important to note that this text file has the same encoding as specified in the import (currently: UTF-8).</p>
<h2><a class="anchor" aria-hidden="true" id="start-import-1"></a><a href="#start-import-1" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Start import</h2>
<p>The import of the advice seekers with advice can be done by calling the endpoint <strong>/users/askers/import</strong> at the UserService (e.g. with Postman). It should be noted that a valid keycloak token of a technical user with the role &quot;technical&quot; must be passed.</p>
<h3><a class="anchor" aria-hidden="true" id="import-log-1"></a><a href="#import-log-1" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Import log</h3>
<p>During the import, a log is written to a file (name and path as specified in <em>application.properties</em>). Additionally, a timestamp is appended so that the file is not overwritten during multiple runs.</p>
<h2><a class="anchor" aria-hidden="true" id="userservice-advice-import-without-advice"></a><a href="#userservice-advice-import-without-advice" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>UserService: Advice import without advice</h2>
<p>UserService can be used to import advice seekers without consultations. During the import, the corresponding accounts are created in Keycloak, in Rocket.Chat and in the application database and the link to the advice center is established.</p>
<p>The import is done via a CSV file with the following format (<strong>The headlines must be removed for the import</strong>):</p>
<pre><code class="hljs">id_old,username,email,agency_id,pw
,asker1,<span class="hljs-symbol">asker1@</span>domain.de,<span class="hljs-number">1332</span>,
<span class="hljs-number">1234</span>,asker2,<span class="hljs-symbol">asker2@</span>domain.de,<span class="hljs-number">1555</span>,
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="fields-description-1"></a><a href="#fields-description-1" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Fields description</h3>
<table>
<thead>
<tr><th>Field</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>id_old</td><td>ID from the old consulting platform</td></tr>
<tr><td>username</td><td>Username</td></tr>
<tr><td>email</td><td>E-Mail address</td></tr>
<tr><td>agency_id</td><td>ID of the consultant to be assigned</td></tr>
<tr><td>pw</td><td>password (optional). If no password is specified, a generated one will be assigned.</td></tr>
</tbody>
</table>
<p>The name and location of the CSV file is set in the <em>application.properties</em> via the <code>asker.import.withoutsession.filename</code>.</p>
<p>The import of the advice seekers with advice can be done by calling the endpoint <strong>/users/askersWithoutSession/import</strong> at the UserService (e.g. with Postman). It should be noted that a valid keycloak token of a technical user with the role &quot;technical&quot; must be passed.</p>
<h3><a class="anchor" aria-hidden="true" id="import-log-2"></a><a href="#import-log-2" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Import log</h3>
<p>During the import, a log is written to a file (name and path as specified in <em>application.properties</em>). Additionally, a timestamp is appended so that the file is not overwritten during multiple runs.</p>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/documentation/docs/backend/openldap-configuration"><span class="arrow-prev">← </span><span class="function-name-prevnext">Configure OpenLDAP</span></a><a class="docs-next button" href="/documentation/docs/backend/mailservice-templates"><span>Mail templates</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#agencyservice-create-master-data">AgencyService: Create master data</a><ul class="toc-headings"><li><a href="#create-dioceses">Create dioceses</a></li><li><a href="#create-agencies">Create agencies</a></li></ul></li><li><a href="#userservice-consultant-import">UserService: Consultant Import</a><ul class="toc-headings"><li><a href="#example-import-new-creation">Example import (new creation)</a></li><li><a href="#update-example">Update example</a></li><li><a href="#description-of-the-fields">Description of the fields</a></li></ul></li><li><a href="#start-import">Start import</a><ul class="toc-headings"><li><a href="#import-log">Import log</a></li></ul></li><li><a href="#userservice-import-of-advice-seekers-with-advice">UserService: Import of advice seekers with advice</a><ul class="toc-headings"><li><a href="#fields-description">Fields description</a></li></ul></li><li><a href="#start-import-1">Start import</a><ul class="toc-headings"><li><a href="#import-log-1">Import log</a></li></ul></li><li><a href="#userservice-advice-import-without-advice">UserService: Advice import without advice</a><ul class="toc-headings"><li><a href="#fields-description-1">Fields description</a></li><li><a href="#import-log-2">Import log</a></li></ul></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/documentation/" class="nav-home"><img src="/documentation/img/caritas_logo.svg" alt="Caritas Online-Beratung" width="66" height="58"/></a><div><h5>Docs</h5><a href="/documentation/docs/general/home.html">Home</a><a href="/documentation/docs/setup/setup-backend.html">Setting up Backend</a><a href="/documentation/docs/setup/setup-frontend.html">Setting up Frontend</a></div><div><h5>More</h5><a href="https://github.com/CaritasDeutschland">GitHub</a></div></section><section class="copyright">Copyright © 2022 Caritas Deutschland</section></footer></div></body></html>